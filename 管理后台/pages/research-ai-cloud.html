<!-- ç§‘ç ”è¶…çº§æ™ºèƒ½ä½“ï¼šAI äº‘ç›˜é¡µé¢ -->
<div class="ai-cloud-page">
    <div class="cloud-header">
        <div class="cloud-title-section">
            <div class="cloud-icon">â˜ï¸</div>
            <h1 class="cloud-title">AI äº‘ç›˜</h1>
        </div>
        <p class="cloud-subtitle">æ™ºèƒ½å­˜å‚¨Â·æ–‡ä»¶ç®¡ç†Â·çŸ¥è¯†æ²‰æ·€</p>
    </div>
    
    <!-- æœç´¢æ  -->
    <div class="cloud-search-bar">
        <input type="text" class="cloud-search-input" placeholder="æœç´¢æ–‡ä»¶æˆ–èµ„æºï¼ˆæ ‡é¢˜å’Œæ­£æ–‡ï¼‰" id="cloudSearchInput">
        <button class="cloud-search-btn" onclick="performCloudSearch()">ğŸ”</button>
    </div>
    
    <!-- æ ‡ç­¾é¡µå¯¼èˆª -->
    <div class="cloud-tabs">
        <button class="cloud-tab active" onclick="switchCloudTab('drive')" id="tabDrive">
            AI äº‘ç›˜
        </button>
        <button class="cloud-tab" onclick="switchCloudTab('smart')" id="tabSmart">
            æ™ºèƒ½åˆ—è¡¨
        </button>
        <button class="cloud-tab" onclick="switchCloudTab('excerpts')" id="tabExcerpts">
            æ‘˜å½•ç¬”è®°
        </button>
        <button class="cloud-tab" onclick="switchCloudTab('tags')" id="tabTags">
            æˆ‘çš„æ ‡ç­¾
        </button>
        <button class="cloud-tab" onclick="switchCloudTab('citations')" id="tabCitations">
            å¼•ç”¨ç®¡ç†
        </button>
    </div>
    
    <!-- å·¥å…·æ  -->
    <div class="cloud-toolbar">
        <div class="toolbar-left">
            <button class="toolbar-icon-btn" onclick="showFilterOptions()" title="ç­›é€‰">
                <span>ğŸ”½</span>
            </button>
            <button class="toolbar-icon-btn" onclick="toggleViewMode()" title="è§†å›¾åˆ‡æ¢">
                <span>ğŸ“‹</span>
            </button>
            <button class="toolbar-icon-btn" onclick="showViewOptions()" title="æŸ¥çœ‹">
                <span>ğŸ‘ï¸</span>
            </button>
            <button class="toolbar-icon-btn" onclick="showShareOptions()" title="åˆ†äº«">
                <span>ğŸ”—</span>
            </button>
            <button class="toolbar-icon-btn" onclick="showDeleteOptions()" title="åˆ é™¤">
                <span>ğŸ—‘ï¸</span>
            </button>
        </div>
        <div class="toolbar-right">
            <div class="new-item-dropdown">
                <button class="toolbar-btn secondary" onclick="toggleNewItemMenu()" id="newItemBtn">
                    <span>+</span>
                    <span>æ–°å»º</span>
                </button>
                <div class="new-item-menu" id="newItemMenu" style="display: none;">
                    <div class="menu-item" onclick="createFolder()">
                        <div class="menu-item-icon">ğŸ“</div>
                        <div class="menu-item-content">
                            <div class="menu-item-title">æ–‡ä»¶å¤¹</div>
                        </div>
                    </div>
                    <div class="menu-divider"></div>
                    <div class="menu-item" onclick="createOnlineNote()">
                        <div class="menu-item-icon">ğŸ“</div>
                        <div class="menu-item-content">
                            <div class="menu-item-title">æ–°å»ºåœ¨çº¿ç¬”è®°</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="createMindMap()">
                        <div class="menu-item-icon">ğŸ—ºï¸</div>
                        <div class="menu-item-content">
                            <div class="menu-item-title">æ–°å»ºæ€ç»´å¯¼å›¾</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="createWhiteboard()">
                        <div class="menu-item-icon">ğŸ–¼ï¸</div>
                        <div class="menu-item-content">
                            <div class="menu-item-title">æ–°å»ºåœ¨çº¿ç™½æ¿</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="upload-dropdown">
                <button class="toolbar-btn primary" onclick="toggleUploadMenu()" id="uploadBtn">
                    <span>ä¸Šä¼ </span>
                </button>
                <div class="upload-menu" id="uploadMenu" style="display: none;">
                    <div class="menu-item" onclick="showUploadDialog('file')">
                        <div class="menu-item-icon">ğŸ“„</div>
                        <div class="menu-item-content">
                            <div class="menu-item-title">
                                ä¸Šä¼ èµ„æ–™
                                <span class="menu-item-hint" title="æ”¯æŒPDFç­‰å¤šç§æ ¼å¼æ–‡ä»¶èµ„æ–™">â„¹ï¸</span>
                            </div>
                            <div class="menu-item-desc">æ”¯æŒPDFç­‰å¤šç§æ ¼å¼æ–‡ä»¶èµ„æ–™</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="showUploadDialog('folder')">
                        <div class="menu-item-icon">ğŸ“</div>
                        <div class="menu-item-content">
                            <div class="menu-item-title">ä¸Šä¼ æ–‡ä»¶å¤¹</div>
                            <div class="menu-item-desc">æ–‡ä»¶å¤¹å°äº500M, ä¸”ä¸è¶…è¿‡50ä¸ªæ–‡ä»¶</div>
                        </div>
                    </div>
                    <div class="menu-divider"></div>
                    <div class="menu-item" onclick="importBibtex()">
                        <div class="menu-item-icon">ğŸ“š</div>
                        <div class="menu-item-content">
                            <div class="menu-item-title">Bibtex è§£æå¯¼å…¥</div>
                            <div class="menu-item-desc">è§£æBibtexé¢˜å½•ï¼Œåˆ›å»ºæ–‡çŒ®å…ƒæ•°æ®</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="importDOI()">
                        <div class="menu-item-icon">ğŸ”</div>
                        <div class="menu-item-content">
                            <div class="menu-item-title">DOI æŸ¥è¯¢å¯¼å…¥</div>
                            <div class="menu-item-desc">æŸ¥è¯¢å¤–æ–‡æ–‡çŒ®DOIï¼Œåˆ›å»ºæ–‡çŒ®å…ƒæ•°æ®</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- AI äº‘ç›˜å†…å®¹åŒºåŸŸ -->
    <div class="cloud-content">
        <!-- AI äº‘ç›˜æ ‡ç­¾é¡µ -->
        <div class="cloud-tab-content active" id="contentDrive">
            <div class="cloud-file-list" id="cloudFileList">
                <!-- æ–‡ä»¶åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <div class="cloud-empty-state" id="cloudEmptyState">
                <div class="empty-icon">â˜ï¸ğŸ“„</div>
                <div class="empty-text">ç‚¹å‡»ã€ä¸Šä¼ ã€‘æ·»åŠ èµ„æ–™</div>
                <div class="empty-hint">æ”¯æŒ PDFã€DOCã€DOCXã€TXT ç­‰æ ¼å¼</div>
            </div>
        </div>
        
        <!-- æ™ºèƒ½åˆ—è¡¨æ ‡ç­¾é¡µ -->
        <div class="cloud-tab-content" id="contentSmart" style="display: none;">
            <div class="smart-list" id="smartList">
                <div class="empty-state-small">æš‚æ— æ™ºèƒ½åˆ—è¡¨</div>
            </div>
        </div>
        
        <!-- æ‘˜å½•ç¬”è®°æ ‡ç­¾é¡µ -->
        <div class="cloud-tab-content" id="contentExcerpts" style="display: none;">
            <div class="excerpts-list" id="excerptsList">
                <div class="empty-state-small">æš‚æ— æ‘˜å½•ç¬”è®°</div>
            </div>
        </div>
        
        <!-- æˆ‘çš„æ ‡ç­¾æ ‡ç­¾é¡µ -->
        <div class="cloud-tab-content" id="contentTags" style="display: none;">
            <div class="tags-manager" id="tagsManager">
                <div class="empty-state-small">æš‚æ— æ ‡ç­¾</div>
            </div>
        </div>
        
        <!-- å¼•ç”¨ç®¡ç†æ ‡ç­¾é¡µ -->
        <div class="cloud-tab-content" id="contentCitations" style="display: none;">
            <div class="citations-list" id="citationsList">
                <div class="empty-state-small">æš‚æ— å¼•ç”¨è®°å½•</div>
            </div>
        </div>
    </div>
    
    <!-- åº•éƒ¨çŠ¶æ€æ  -->
    <div class="cloud-footer">
        <div class="cloud-status" id="cloudStatus">å·²å…¨éƒ¨åŠ è½½ï¼Œå…± 0 ä¸ª</div>
    </div>
    
    <!-- ä¸Šä¼ å¯¹è¯æ¡† -->
    <div class="upload-dialog" id="uploadDialog" style="display: none;">
        <div class="upload-dialog-overlay" onclick="closeUploadDialog()"></div>
        <div class="upload-dialog-content">
            <div class="upload-dialog-header">
                <h3>ä¸Šä¼ æ–‡ä»¶</h3>
                <button class="upload-dialog-close" onclick="closeUploadDialog()">Ã—</button>
            </div>
            <div class="upload-dialog-body">
                <div class="upload-area-large" id="uploadAreaLarge" onclick="triggerFileUpload()">
                    <div class="upload-icon-large">ğŸ“„</div>
                    <div class="upload-text-large">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„ä¸Šä¼ </div>
                    <div class="upload-hint-large">æ”¯æŒ PDFã€DOCã€DOCXã€TXTã€PPTã€PPTX ç­‰æ ¼å¼</div>
                    <input type="file" id="fileUploadInput" style="display: none;" multiple accept=".pdf,.doc,.docx,.txt,.ppt,.pptx" onchange="handleFileUpload(event)">
                </div>
                <div class="upload-file-list" id="uploadFileList">
                    <!-- å¾…ä¸Šä¼ æ–‡ä»¶åˆ—è¡¨ -->
                </div>
            </div>
            <div class="upload-dialog-footer">
                <button class="btn btn-default" onclick="closeUploadDialog()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="confirmUpload()">å¼€å§‹ä¸Šä¼ </button>
            </div>
        </div>
    </div>
</div>

<style>
/* AI äº‘ç›˜é¡µé¢æ ·å¼ */
.ai-cloud-page {
    padding: 24px;
    max-width: 1600px;
    margin: 0 auto;
}

.cloud-header {
    text-align: center;
    margin-bottom: 24px;
}

.cloud-title-section {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin-bottom: 8px;
}

.cloud-icon {
    font-size: 48px;
}

.cloud-title {
    font-size: 36px;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0;
}

.cloud-subtitle {
    font-size: 16px;
    color: #666;
    margin: 0;
}

/* æœç´¢æ  */
.cloud-search-bar {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
}

.cloud-search-input {
    flex: 1;
    padding: 12px 16px;
    border: 1px solid #d9d9d9;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.3s;
}

.cloud-search-input:focus {
    outline: none;
    border-color: #1890ff;
    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.1);
}

.cloud-search-btn {
    padding: 12px 24px;
    background: #1890ff;
    color: #fff;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s;
}

.cloud-search-btn:hover {
    background: #40a9ff;
}

/* æ ‡ç­¾é¡µ */
.cloud-tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 20px;
    border-bottom: 1px solid #e8e8e8;
}

.cloud-tab {
    padding: 12px 24px;
    border: none;
    background: transparent;
    color: #666;
    font-size: 14px;
    cursor: pointer;
    border-bottom: 2px solid transparent;
    transition: all 0.3s;
}

.cloud-tab:hover {
    color: #1890ff;
}

.cloud-tab.active {
    color: #1890ff;
    border-bottom-color: #1890ff;
    font-weight: 600;
}

/* å·¥å…·æ  */
.cloud-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    margin-bottom: 20px;
    border-bottom: 1px solid #e8e8e8;
}

.toolbar-left {
    display: flex;
    gap: 8px;
}

.toolbar-right {
    display: flex;
    gap: 12px;
}

.toolbar-btn {
    padding: 8px 16px;
    border: 1px solid #d9d9d9;
    border-radius: 6px;
    background: #fff;
    color: #666;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.3s;
}

.toolbar-btn:hover {
    border-color: #1890ff;
    color: #1890ff;
}

.toolbar-btn.secondary {
    background: #f5f5f5;
}

.toolbar-btn.primary {
    background: #722ed1;
    color: #fff;
    border-color: #722ed1;
}

.toolbar-btn.primary:hover {
    background: #9254de;
    border-color: #9254de;
}

.toolbar-icon-btn {
    width: 32px;
    height: 32px;
    padding: 0;
    border: 1px solid #d9d9d9;
    border-radius: 6px;
    background: #fff;
    color: #666;
    font-size: 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
}

.toolbar-icon-btn:hover {
    border-color: #1890ff;
    color: #1890ff;
}

/* æ–°å»ºä¸‹æ‹‰èœå• */
.new-item-dropdown,
.upload-dropdown {
    position: relative;
}

.upload-menu {
    position: absolute;
    top: 100%;
    right: 0;
    margin-top: 8px;
    background: #fff;
    border: 1px solid #d9d9d9;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 100;
    min-width: 280px;
    padding: 8px 0;
}

.new-item-menu {
    position: absolute;
    top: 100%;
    right: 0;
    margin-top: 8px;
    background: #fff;
    border: 1px solid #d9d9d9;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 100;
    min-width: 280px;
    padding: 8px 0;
}

.menu-item {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 12px 16px;
    cursor: pointer;
    transition: background 0.2s;
}

.menu-item:hover {
    background: #f5f5f5;
}

.menu-item-icon {
    font-size: 20px;
    flex-shrink: 0;
    margin-top: 2px;
}

.menu-item-content {
    flex: 1;
}

.menu-item-title {
    font-size: 14px;
    font-weight: 500;
    color: #1a1a1a;
    margin-bottom: 4px;
    display: flex;
    align-items: center;
    gap: 6px;
}

.menu-item-hint {
    font-size: 12px;
    color: #999;
    cursor: help;
}

.menu-item-desc {
    font-size: 12px;
    color: #999;
    line-height: 1.4;
}

.menu-divider {
    height: 1px;
    background: #e8e8e8;
    margin: 8px 0;
}

/* å†…å®¹åŒºåŸŸ */
.cloud-content {
    min-height: 400px;
    background: #fff;
    border-radius: 8px;
    padding: 24px;
}

.cloud-tab-content {
    min-height: 400px;
}

/* æ–‡ä»¶åˆ—è¡¨ */
.cloud-file-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 16px;
}

.cloud-file-item {
    border: 1px solid #e8e8e8;
    border-radius: 8px;
    padding: 16px;
    cursor: pointer;
    transition: all 0.3s;
    position: relative;
}

.cloud-file-item:hover {
    border-color: #1890ff;
    box-shadow: 0 2px 8px rgba(24, 144, 255, 0.1);
}

.file-icon {
    font-size: 48px;
    text-align: center;
    margin-bottom: 12px;
}

.file-name {
    font-size: 14px;
    font-weight: 600;
    color: #1a1a1a;
    margin-bottom: 8px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.file-meta {
    font-size: 12px;
    color: #999;
    margin-bottom: 8px;
}

.file-actions {
    display: flex;
    gap: 8px;
    margin-top: 12px;
}

.file-action-btn {
    padding: 4px 8px;
    border: 1px solid #d9d9d9;
    border-radius: 4px;
    background: #fff;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.3s;
}

.file-action-btn:hover {
    border-color: #1890ff;
    color: #1890ff;
}

/* ç©ºçŠ¶æ€ */
.cloud-empty-state {
    text-align: center;
    padding: 80px 20px;
    display: none;
}

.cloud-empty-state.show {
    display: block;
}

.empty-icon {
    font-size: 64px;
    margin-bottom: 16px;
}

.empty-text {
    font-size: 18px;
    color: #1a1a1a;
    margin-bottom: 8px;
    font-weight: 600;
}

.empty-hint {
    font-size: 14px;
    color: #999;
}

.empty-state-small {
    text-align: center;
    padding: 60px 20px;
    color: #999;
    font-size: 14px;
}

/* åº•éƒ¨çŠ¶æ€æ  */
.cloud-footer {
    margin-top: 20px;
    padding: 12px 0;
    text-align: center;
    border-top: 1px solid #e8e8e8;
}

.cloud-status {
    font-size: 14px;
    color: #666;
}

/* ä¸Šä¼ å¯¹è¯æ¡† */
.upload-dialog {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 1000;
}

.upload-dialog-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
}

.upload-dialog-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #fff;
    border-radius: 8px;
    width: 90%;
    max-width: 600px;
    max-height: 80vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.upload-dialog-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 24px;
    border-bottom: 1px solid #e8e8e8;
}

.upload-dialog-header h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
}

.upload-dialog-close {
    width: 32px;
    height: 32px;
    border: none;
    background: transparent;
    font-size: 24px;
    cursor: pointer;
    color: #999;
}

.upload-dialog-close:hover {
    color: #1a1a1a;
}

.upload-dialog-body {
    flex: 1;
    overflow-y: auto;
    padding: 24px;
}

.upload-area-large {
    border: 2px dashed #d9d9d9;
    border-radius: 8px;
    padding: 60px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
    margin-bottom: 20px;
}

.upload-area-large:hover {
    border-color: #1890ff;
    background: #f0f7ff;
}

.upload-icon-large {
    font-size: 64px;
    margin-bottom: 16px;
}

.upload-text-large {
    font-size: 16px;
    color: #1a1a1a;
    margin-bottom: 8px;
    font-weight: 600;
}

.upload-hint-large {
    font-size: 14px;
    color: #999;
}

.upload-file-list {
    margin-top: 20px;
}

.upload-file-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background: #f5f5f5;
    border-radius: 6px;
    margin-bottom: 8px;
}

.upload-file-name {
    flex: 1;
    font-size: 14px;
    color: #1a1a1a;
}

.upload-file-size {
    font-size: 12px;
    color: #999;
}

.upload-file-remove {
    width: 24px;
    height: 24px;
    border: none;
    background: transparent;
    color: #999;
    cursor: pointer;
    font-size: 18px;
}

.upload-file-remove:hover {
    color: #f5222d;
}

.upload-dialog-footer {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    padding: 16px 24px;
    border-top: 1px solid #e8e8e8;
}

.btn {
    padding: 8px 24px;
    border: 1px solid #d9d9d9;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s;
}

.btn-default {
    background: #fff;
    color: #666;
}

.btn-default:hover {
    border-color: #1890ff;
    color: #1890ff;
}

.btn-primary {
    background: #1890ff;
    color: #fff;
    border-color: #1890ff;
}

.btn-primary:hover {
    background: #40a9ff;
    border-color: #40a9ff;
}
</style>

<script>
// å½“å‰é€‰ä¸­çš„æ ‡ç­¾é¡µ
let currentTab = 'drive';
let fileList = [];

// åˆ‡æ¢æ ‡ç­¾é¡µ
function switchCloudTab(tab) {
    currentTab = tab;
    
    // æ›´æ–°æ ‡ç­¾é¡µçŠ¶æ€
    document.querySelectorAll('.cloud-tab').forEach(btn => btn.classList.remove('active'));
    document.getElementById('tab' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');
    
    // æ›´æ–°å†…å®¹åŒºåŸŸ
    document.querySelectorAll('.cloud-tab-content').forEach(content => {
        content.style.display = 'none';
    });
    document.getElementById('content' + tab.charAt(0).toUpperCase() + tab.slice(1)).style.display = 'block';
    
    // æ ¹æ®æ ‡ç­¾é¡µåŠ è½½å†…å®¹
    loadTabContent(tab);
}

// åŠ è½½æ ‡ç­¾é¡µå†…å®¹
function loadTabContent(tab) {
    switch(tab) {
        case 'drive':
            loadFileList();
            break;
        case 'smart':
            loadSmartList();
            break;
        case 'excerpts':
            loadExcerpts();
            break;
        case 'tags':
            loadTags();
            break;
        case 'citations':
            loadCitations();
            break;
    }
}

// åŠ è½½æ–‡ä»¶åˆ—è¡¨
function loadFileList() {
    const fileListEl = document.getElementById('cloudFileList');
    const emptyState = document.getElementById('cloudEmptyState');
    
    if (fileList.length === 0) {
        fileListEl.style.display = 'none';
        emptyState.classList.add('show');
    } else {
        fileListEl.style.display = 'grid';
        emptyState.classList.remove('show');
        
        fileListEl.innerHTML = fileList.map((file, index) => `
            <div class="cloud-file-item" onclick="openFile(${index})">
                <div class="file-icon">${getFileIcon(file.type)}</div>
                <div class="file-name" title="${file.name}">${file.name}</div>
                <div class="file-meta">
                    <div>å¤§å°ï¼š${formatFileSize(file.size)}</div>
                    <div>ä¸Šä¼ æ—¶é—´ï¼š${file.uploadTime}</div>
                </div>
                <div class="file-actions">
                    <button class="file-action-btn" onclick="event.stopPropagation(); downloadFile(${index})">ä¸‹è½½</button>
                    <button class="file-action-btn" onclick="event.stopPropagation(); deleteFile(${index})">åˆ é™¤</button>
                </div>
            </div>
        `).join('');
    }
    
    updateStatus();
}

// è·å–æ–‡ä»¶å›¾æ ‡
function getFileIcon(type) {
    const icons = {
        'pdf': 'ğŸ“„',
        'doc': 'ğŸ“',
        'docx': 'ğŸ“',
        'txt': 'ğŸ“ƒ',
        'ppt': 'ğŸ“Š',
        'pptx': 'ğŸ“Š'
    };
    return icons[type] || 'ğŸ“„';
}

// æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
function formatFileSize(bytes) {
    if (bytes < 1024) return bytes + ' B';
    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(2) + ' KB';
    return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
}

// åŠ è½½æ™ºèƒ½åˆ—è¡¨
function loadSmartList() {
    // æ¨¡æ‹Ÿæ•°æ®
    document.getElementById('smartList').innerHTML = '<div class="empty-state-small">æš‚æ— æ™ºèƒ½åˆ—è¡¨</div>';
}

// åŠ è½½æ‘˜å½•ç¬”è®°
function loadExcerpts() {
    // æ¨¡æ‹Ÿæ•°æ®
    document.getElementById('excerptsList').innerHTML = '<div class="empty-state-small">æš‚æ— æ‘˜å½•ç¬”è®°</div>';
}

// åŠ è½½æ ‡ç­¾
function loadTags() {
    // æ¨¡æ‹Ÿæ•°æ®
    document.getElementById('tagsManager').innerHTML = '<div class="empty-state-small">æš‚æ— æ ‡ç­¾</div>';
}

// åŠ è½½å¼•ç”¨
function loadCitations() {
    // æ¨¡æ‹Ÿæ•°æ®
    document.getElementById('citationsList').innerHTML = '<div class="empty-state-small">æš‚æ— å¼•ç”¨è®°å½•</div>';
}

// æ›´æ–°çŠ¶æ€æ 
function updateStatus() {
    const statusEl = document.getElementById('cloudStatus');
    statusEl.textContent = `å·²å…¨éƒ¨åŠ è½½ï¼Œå…± ${fileList.length} ä¸ª`;
}

// æ‰§è¡Œæœç´¢
function performCloudSearch() {
    const keyword = document.getElementById('cloudSearchInput').value.trim();
    if (!keyword) {
        alert('è¯·è¾“å…¥æœç´¢å…³é”®è¯');
        return;
    }
    
    // æ¨¡æ‹Ÿæœç´¢
    alert(`æœç´¢å…³é”®è¯ï¼š${keyword}\n\nï¼ˆå®é™…åº”ç”¨ä¸­åº”è°ƒç”¨æœç´¢APIï¼‰`);
}

// æ˜¾ç¤ºä¸Šä¼ å¯¹è¯æ¡†
function showUploadDialog(type) {
    document.getElementById('uploadDialog').style.display = 'block';
    if (type === 'folder') {
        // å¦‚æœæ˜¯ä¸Šä¼ æ–‡ä»¶å¤¹ï¼Œéœ€è¦è®¾ç½®multipleå’Œwebkitdirectoryå±æ€§
        const input = document.getElementById('fileUploadInput');
        input.setAttribute('webkitdirectory', '');
        input.setAttribute('multiple', '');
    } else {
        const input = document.getElementById('fileUploadInput');
        input.removeAttribute('webkitdirectory');
    }
    // å…³é—­ä¸Šä¼ èœå•
    document.getElementById('uploadMenu').style.display = 'none';
}

// å…³é—­ä¸Šä¼ å¯¹è¯æ¡†
function closeUploadDialog() {
    document.getElementById('uploadDialog').style.display = 'none';
    document.getElementById('uploadFileList').innerHTML = '';
}

// è§¦å‘æ–‡ä»¶ä¸Šä¼ 
function triggerFileUpload() {
    document.getElementById('fileUploadInput').click();
}

// å¤„ç†æ–‡ä»¶ä¸Šä¼ 
function handleFileUpload(event) {
    const files = Array.from(event.target.files);
    const fileListEl = document.getElementById('uploadFileList');
    
    fileListEl.innerHTML = files.map((file, index) => `
        <div class="upload-file-item">
            <div class="upload-file-name">${file.name}</div>
            <div class="upload-file-size">${formatFileSize(file.size)}</div>
            <button class="upload-file-remove" onclick="removeUploadFile(${index})">Ã—</button>
        </div>
    `).join('');
}

// ç§»é™¤å¾…ä¸Šä¼ æ–‡ä»¶
function removeUploadFile(index) {
    // å®é™…åº”ç”¨ä¸­éœ€è¦ä»æ–‡ä»¶åˆ—è¡¨ä¸­ç§»é™¤
    alert('ç§»é™¤æ–‡ä»¶ï¼ˆæ¨¡æ‹Ÿï¼‰');
}

// ç¡®è®¤ä¸Šä¼ 
function confirmUpload() {
    const files = document.getElementById('fileUploadInput').files;
    if (files.length === 0) {
        alert('è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶');
        return;
    }
    
    // æ¨¡æ‹Ÿä¸Šä¼ 
    Array.from(files).forEach(file => {
        fileList.push({
            name: file.name,
            type: file.name.split('.').pop().toLowerCase(),
            size: file.size,
            uploadTime: new Date().toLocaleString('zh-CN')
        });
    });
    
    closeUploadDialog();
    loadFileList();
    alert('æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');
}

// æ‰“å¼€æ–‡ä»¶
function openFile(index) {
    const file = fileList[index];
    alert(`æ‰“å¼€æ–‡ä»¶ï¼š${file.name}\n\nï¼ˆå®é™…åº”ç”¨ä¸­åº”è°ƒç”¨æ–‡ä»¶é¢„è§ˆAPIï¼‰`);
}

// ä¸‹è½½æ–‡ä»¶
function downloadFile(index) {
    const file = fileList[index];
    alert(`æ­£åœ¨ä¸‹è½½ï¼š${file.name}\n\nï¼ˆå®é™…åº”ç”¨ä¸­åº”è°ƒç”¨ä¸‹è½½APIï¼‰`);
}

// åˆ é™¤æ–‡ä»¶
function deleteFile(index) {
    if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ–‡ä»¶å—ï¼Ÿ')) {
        fileList.splice(index, 1);
        loadFileList();
    }
}

// åˆ‡æ¢æ–°å»ºèœå•
function toggleNewItemMenu() {
    const menu = document.getElementById('newItemMenu');
    menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
}

// ç‚¹å‡»å¤–éƒ¨å…³é—­èœå•
document.addEventListener('click', function(e) {
    const newBtn = document.getElementById('newItemBtn');
    const newMenu = document.getElementById('newItemMenu');
    const uploadBtn = document.getElementById('uploadBtn');
    const uploadMenu = document.getElementById('uploadMenu');
    
    if (newBtn && newMenu && !newBtn.contains(e.target) && !newMenu.contains(e.target)) {
        newMenu.style.display = 'none';
    }
    
    if (uploadBtn && uploadMenu && !uploadBtn.contains(e.target) && !uploadMenu.contains(e.target)) {
        uploadMenu.style.display = 'none';
    }
});

// åˆ›å»ºæ–‡ä»¶å¤¹
function createFolder() {
    document.getElementById('newItemMenu').style.display = 'none';
    const folderName = prompt('è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°ï¼š');
    if (folderName) {
        alert(`åˆ›å»ºæ–‡ä»¶å¤¹ï¼š${folderName}\n\nï¼ˆå®é™…åº”ç”¨ä¸­åº”è°ƒç”¨åˆ›å»ºæ–‡ä»¶å¤¹APIï¼‰`);
    }
}

// æ–°å»ºåœ¨çº¿ç¬”è®°
function createOnlineNote() {
    document.getElementById('newItemMenu').style.display = 'none';
    alert('æ–°å»ºåœ¨çº¿ç¬”è®°ï¼ˆæ¨¡æ‹Ÿï¼‰\n\nï¼ˆå®é™…åº”ç”¨ä¸­åº”æ‰“å¼€åœ¨çº¿ç¬”è®°ç¼–è¾‘å™¨ï¼‰');
}

// æ–°å»ºæ€ç»´å¯¼å›¾
function createMindMap() {
    document.getElementById('newItemMenu').style.display = 'none';
    alert('æ–°å»ºæ€ç»´å¯¼å›¾ï¼ˆæ¨¡æ‹Ÿï¼‰\n\nï¼ˆå®é™…åº”ç”¨ä¸­åº”æ‰“å¼€æ€ç»´å¯¼å›¾ç¼–è¾‘å™¨ï¼‰');
}

// æ–°å»ºåœ¨çº¿ç™½æ¿
function createWhiteboard() {
    document.getElementById('newItemMenu').style.display = 'none';
    alert('æ–°å»ºåœ¨çº¿ç™½æ¿ï¼ˆæ¨¡æ‹Ÿï¼‰\n\nï¼ˆå®é™…åº”ç”¨ä¸­åº”æ‰“å¼€åœ¨çº¿ç™½æ¿ç¼–è¾‘å™¨ï¼‰');
}

// åˆ‡æ¢ä¸Šä¼ èœå•
function toggleUploadMenu() {
    const menu = document.getElementById('uploadMenu');
    menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
    // å…³é—­æ–°å»ºèœå•
    document.getElementById('newItemMenu').style.display = 'none';
}

// Bibtex è§£æå¯¼å…¥
function importBibtex() {
    document.getElementById('uploadMenu').style.display = 'none';
    alert('Bibtex è§£æå¯¼å…¥ï¼ˆæ¨¡æ‹Ÿï¼‰\n\nï¼ˆå®é™…åº”ç”¨ä¸­åº”æ‰“å¼€Bibtexå¯¼å…¥å¯¹è¯æ¡†ï¼‰');
}

// DOI æŸ¥è¯¢å¯¼å…¥
function importDOI() {
    document.getElementById('uploadMenu').style.display = 'none';
    alert('DOI æŸ¥è¯¢å¯¼å…¥ï¼ˆæ¨¡æ‹Ÿï¼‰\n\nï¼ˆå®é™…åº”ç”¨ä¸­åº”æ‰“å¼€DOIæŸ¥è¯¢å¯¹è¯æ¡†ï¼‰');
}

// åˆ‡æ¢è§†å›¾æ¨¡å¼
function toggleViewMode() {
    alert('åˆ‡æ¢è§†å›¾æ¨¡å¼ï¼ˆæ¨¡æ‹Ÿï¼‰\n\nï¼ˆå®é™…åº”ç”¨ä¸­åº”åœ¨ç½‘æ ¼è§†å›¾å’Œåˆ—è¡¨è§†å›¾ä¹‹é—´åˆ‡æ¢ï¼‰');
}

// æ˜¾ç¤ºæŸ¥çœ‹é€‰é¡¹
function showViewOptions() {
    alert('æŸ¥çœ‹é€‰é¡¹ï¼ˆæ¨¡æ‹Ÿï¼‰');
}

// æ˜¾ç¤ºåˆ†äº«é€‰é¡¹
function showShareOptions() {
    alert('åˆ†äº«é€‰é¡¹ï¼ˆæ¨¡æ‹Ÿï¼‰');
}

// æ˜¾ç¤ºç­›é€‰é€‰é¡¹
function showFilterOptions() {
    alert('ç­›é€‰é€‰é¡¹ï¼ˆæ¨¡æ‹Ÿï¼‰');
}

// æ˜¾ç¤ºæ’åºé€‰é¡¹
function showSortOptions() {
    alert('æ’åºé€‰é¡¹ï¼ˆæ¨¡æ‹Ÿï¼‰');
}

// æ˜¾ç¤ºåˆ é™¤é€‰é¡¹
function showDeleteOptions() {
    alert('æ‰¹é‡åˆ é™¤ï¼ˆæ¨¡æ‹Ÿï¼‰');
}

// åˆå§‹åŒ–é¡µé¢
function initPage_research_ai_cloud() {
    console.log('AI äº‘ç›˜é¡µé¢å·²åŠ è½½');
    loadFileList();
}
</script>
